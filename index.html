<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>FETTENAJS X-ray viewer</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css2?family=Exo+2" rel="stylesheet" />
  <link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Montserrat">
  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/magnific-popup.css">

  <!-- Custom xray css-->
  <link rel="stylesheet" href="css/xray.css" />
  <link rel="stylesheet" href="css/loader.css" />

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- <link rel="icon" type="image/png" href="images/favicon.png"> -->

  <!-- JS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="js/magnific-popup.js"></script>

  <!-- Custom xray JS -->
  <script>/*for templating*/</script>
  <script src="js/xray.js"></script>
  <script>
    $(document).ready(function() {
        //https://stackoverflow.com/questions/5999118/how-can-i-add-or-update-a-query-string-parameter
        const getUriWithParam = (baseUrl, params) => {
            const Url = new URL(baseUrl);
            const urlParams = new URLSearchParams(Url.search);
            for (const key in params) {
                if (params[key] !== undefined) {
                urlParams.set(key, params[key]);
                }
            }
            Url.search = urlParams.toString();
            return Url.toString();
        };

		const params = new URL(location.href).searchParams;
		const diagnosis = params.get('diagnosis');

        const localurl = window.location.href;
        //console.log(localurl);
        
        if(diagnosis == "on") {
            coursesuffix = "&diagnosis=on";
            dgsuffix = "";
            var dgswitchhref = getUriWithParam(localurl, {diagnosis: "off"});
            //console.log("test log to off: " + test);
        } else {
            coursesuffix = "&diagnosis=off";
            var dgswitchhref = getUriWithParam(localurl, {diagnosis: "on"});
            //console.log("test log to on: " + test);

        }

        var orthohref = "ortho" + coursesuffix;
        var pulmohref = "pulmo" + coursesuffix;
        var pedsurghref = "pedsurg" + coursesuffix;

        var ortholink = document.getElementById('ortholink');
        ortholink.href = orthohref;

        var pulmolink = document.getElementById('pulmolink');
        pulmolink.href = pulmohref;

        var pedsurglink = document.getElementById('pedsurglink');
        pedsurglink.href = pedsurghref;

        var dglinkid = document.getElementById('dglinkswitch');
        dglinkid.href = dgswitchhref;


    })
  </script>

</head>
<body onload="loaded()">

    <div class="container" id="loader">Loading all images</div>

<div class="container" id="divnav">
    <ul id="nav">
        <!-- <li><a href="#home">Home</a></li> -->
        <li><a href="/"><img src="graphics/Xray_logo.png" height="40"/></a></li>
        <!-- <li><a href="/">fettenajs xray viewer</a></li> -->
        <li><a id="ortholink">Orthopaedics</a></li>
        <li><a id="pulmolink">Pulmonology</a></li>
        <li><a id="pedsurglink">Pediatric surgery</a></li>
        <li><a id="dglinkswitch" style="color: red">Diagnosis ON/OFF</a></li>
    </ul>
</div>

<div class="container" style="text-align: center; margin-top: 30px;" id="loadingadviced">
<p>Please be advised, the page may take some time to load.</p>
</div>

<div class="container" id="main" style="padding-top: 30px;">
    <table id="tableMain">

    </table>
</div>
</body>
<script>
function loaded() {
    console.log("loaded");
    $("#loadingadviced").hide();
    document.getElementById("loader").style.display = "none";
    document.getElementById("main").style.display = "block";
}
</script>
</html>